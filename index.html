<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±è¯­å¬å†™ç»ƒä¹  (åˆ†å¤©ç‰ˆ)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 800px;
            width: 100%;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        /* Day Selection Styles */
        .day-selector {
            text-align: center;
            margin-bottom: 30px;
        }

        select {
            padding: 10px 20px;
            font-size: 1.1em;
            border-radius: 10px;
            border: 2px solid #667eea;
            color: #2d3748;
            outline: none;
            cursor: pointer;
            background: white;
        }

        .status {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .status-item:last-child {
            margin-bottom: 0;
        }

        .label {
            color: #718096;
            font-weight: 600;
        }

        .value {
            color: #2d3748;
            font-weight: bold;
        }

        .progress {
            background: #e2e8f0;
            border-radius: 10px;
            height: 30px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .current-word {
            text-align: center;
            font-size: 3em;
            font-weight: bold;
            color: #2d3748;
            margin: 40px 0;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .starting {
            text-align: center;
            font-size: 1.5em;
            color: #667eea;
            margin: 40px 0;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .controls {
            text-align: center;
            margin-top: 30px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .answers {
            display: none;
            margin-top: 30px;
        }

        .answers h2 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }

        .answer-list {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .answer-item {
            padding: 12px;
            margin-bottom: 8px;
            background: white;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .answer-left {
            display: flex;
            align-items: center;
        }

        .answer-number {
            color: #667eea;
            font-weight: bold;
            margin-right: 15px;
            min-width: 30px;
        }

        .answer-text {
            color: #2d3748;
            font-size: 1.2em;
            font-weight: 500;
        }

        .answer-meaning {
            color: #718096;
            font-size: 1em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ è‹±è¯­å¬å†™ç»ƒä¹ </h1>

        <div class="day-selector">
            <select id="daySelect" onchange="loadDay()">
                <option value="Day 1">Day 1 (20 words)</option>
                <option value="Day 2">Day 2 (20 words)</option>
                <option value="Day 3">Day 3 (3 words)</option>
            </select>
        </div>

        <div class="status">
            <div class="status-item">
                <span class="label">æœ¬ç»„è¯æ•°ï¼š</span>
                <span class="value" id="totalCount">20</span>
            </div>
            <div class="status-item">
                <span class="label">å½“å‰è¿›åº¦ï¼š</span>
                <span class="value" id="currentProgress">0 / 20</span>
            </div>
            <div class="status-item">
                <span class="label">æ¯è¯é‡å¤ï¼š</span>
                <span class="value">3 æ¬¡</span>
            </div>
            <div class="status-item">
                <span class="label">é—´éš”æ—¶é—´ï¼š</span>
                <span class="value">10 ç§’</span>
            </div>
        </div>

        <div class="progress">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>

        <div class="current-word" id="currentWord" style="display: none;"></div>
        <div class="starting" id="starting">å‡†å¤‡å¼€å§‹...</div>

        <div class="controls">
            <button id="startBtn" onclick="startDictation()">å¼€å§‹å¬å†™</button>
            <button id="pauseBtn" onclick="pauseDictation()" style="display: none;" disabled>æš‚åœ</button>
            <button id="resumeBtn" onclick="resumeDictation()" style="display: none;">ç»§ç»­</button>
            <button id="restartBtn" onclick="resetDictation()" style="display: none; background: #e53e3e;">é‡ç½®</button>
        </div>

        <div class="answers" id="answers">
            <h2>ğŸ“ å¬å†™ç­”æ¡ˆ</h2>
            <div class="answer-list" id="answerList"></div>
        </div>
    </div>

    <script>
        // å•è¯æ•°æ®æº
        const wordData = {
            "Day 1": [
                { "text": "country", "meaning": "å›½å®¶" },
                { "text": "animal", "meaning": "åŠ¨ç‰©" },
                { "text": "every", "meaning": "æ¯" },
                { "text": "during", "meaning": "åœ¨...æœŸé—´" },
                { "text": "coloured", "meaning": "å½©è‰²çš„" },
                { "text": "ability", "meaning": "èƒ½åŠ›" },
                { "text": "together", "meaning": "ä¸€èµ·" },
                { "text": "ice cream", "meaning": "å†°æ·‡æ·‹" },
                { "text": "busy", "meaning": "å¿™çš„" },
                { "text": "wake up", "meaning": "é†’æ¥" },
                { "text": "early", "meaning": "æ—©åœ°; æ—©çš„" },
                { "text": "palace", "meaning": "å®«æ®¿" },
                { "text": "Children's Palace", "meaning": "å°‘å¹´å®«" },
                { "text": "cinema", "meaning": "ç”µå½±é™¢" },
                { "text": "seldom", "meaning": "æå°‘åœ°" },
                { "text": "stay", "meaning": "åœç•™; å¾…åœ¨..." },
                { "text": "sure", "meaning": "ç¡®ä¿¡; è‚¯å®šçš„" },
                { "text": "a bottle of", "meaning": "ä¸€ç“¶..." },
                { "text": "juice", "meaning": "æœæ±" },
                { "text": "should", "meaning": "åº”è¯¥" }
            ],
            "Day 2": [
                { "text": "sandwich", "meaning": "ä¸‰æ˜æ²»" },
                { "text": "hamburger", "meaning": "æ±‰å ¡åŒ…" },
                { "text": "starter", "meaning": "ç¬¬ä¸€é“èœ" },
                { "text": "main course", "meaning": "ä¸»èœ" },
                { "text": "meat", "meaning": "è‚‰" },
                { "text": "vegetable", "meaning": "è”¬èœ" },
                { "text": "potato", "meaning": "é©¬é“ƒè–¯" },
                { "text": "dessert", "meaning": "ç”œå“" },
                { "text": "chocolate", "meaning": "å·§å…‹åŠ›" },
                { "text": "start", "meaning": "å¼€å§‹; å‡ºå‘" },
                { "text": "again", "meaning": "å†; å†ä¸€æ¬¡" },
                { "text": "England", "meaning": "è‹±æ ¼å…°; è‹±å›½" },
                { "text": "report", "meaning": "æŠ¥å‘Š" },
                { "text": "season", "meaning": "å­£èŠ‚" },
                { "text": "temperature", "meaning": "æ¸©åº¦" },
                { "text": "degree", "meaning": "åº¦" },
                { "text": "quickly", "meaning": "è¿…é€Ÿåœ°; é£å¿«åœ°" },
                { "text": "change", "meaning": "æ”¹å˜" },
                { "text": "lunchtime", "meaning": "åˆé¤æ—¶åˆ»" },
                { "text": "umbrella", "meaning": "é›¨ä¼" }
            ],
            "Day 3": [
                { "text": "thought", "meaning": "æƒ³ (thinkçš„è¿‡å»å¼)" },
                { "text": "finish", "meaning": "å®Œæˆ" },
                { "text": "true", "meaning": "çœŸå®çš„" }
            ]
        };

        let currentDayWords = [];
        let currentIndex = 0;
        let isPaused = false;
        let isRunning = false;
        const REPEAT_COUNT = 3; // æ¯ä¸ªå•è¯è¯»3é
        const INTERVAL = 10000; // é—´éš”10ç§’

        // åˆå§‹åŒ–åŠ è½½ Day 1
        window.onload = function() {
            loadDay();
        };

        function loadDay() {
            if (isRunning) {
                alert("è¯·å…ˆåœæ­¢å½“å‰å¬å†™å†åˆ‡æ¢å¤©æ•°ï¼");
                document.getElementById('daySelect').value = Object.keys(wordData).find(key => wordData[key] === currentDayWords);
                return;
            }
            
            const selectedDay = document.getElementById('daySelect').value;
            currentDayWords = wordData[selectedDay];
            
            // æ›´æ–°çŠ¶æ€æ 
            document.getElementById('totalCount').textContent = currentDayWords.length;
            document.getElementById('currentProgress').textContent = `0 / ${currentDayWords.length}`;
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('progressBar').textContent = '0%';
            
            // é‡ç½®ç•Œé¢
            resetUI();
        }

        function resetUI() {
            document.getElementById('answers').style.display = 'none';
            document.getElementById('starting').style.display = 'flex';
            document.getElementById('starting').textContent = 'å‡†å¤‡å°±ç»ªï¼Œç‚¹å‡»å¼€å§‹';
            document.getElementById('currentWord').style.display = 'none';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('restartBtn').style.display = 'none';
            document.getElementById('daySelect').disabled = false;
        }

        async function startDictation() {
            // æ£€æŸ¥æµè§ˆå™¨æ”¯æŒ
            if (!('speechSynthesis' in window)) {
                alert("æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³æœ—è¯»åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ Chrome/Edge/Safari ç­‰ç°ä»£æµè§ˆå™¨ã€‚");
                return;
            }

            isRunning = true;
            currentIndex = 0;
            document.getElementById('daySelect').disabled = true;
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').disabled = false;
            document.getElementById('restartBtn').style.display = 'none';
            document.getElementById('answers').style.display = 'none';

            const startingEl = document.getElementById('starting');
            startingEl.style.display = 'flex';
            
            // å€’è®¡æ—¶
            for (let i = 3; i > 0; i--) {
                startingEl.textContent = `å¬å†™å°†åœ¨ ${i} ç§’åå¼€å§‹...`;
                await sleep(1000);
            }
            startingEl.style.display = 'none';
            document.getElementById('currentWord').style.display = 'flex';

            // å¼€å§‹å¾ªç¯æ’­æ”¾å•è¯
            for (let i = 0; i < currentDayWords.length; i++) {
                currentIndex = i;
                updateProgress();
                await dictateItem(i);
                
                // å¦‚æœæš‚åœäº†ï¼Œç­‰å¾…æ¢å¤
                while (isPaused) {
                    await sleep(100);
                }
            }

            finishDictation();
        }

        async function dictateItem(index) {
            const word = currentDayWords[index];
            const displayEl = document.getElementById('currentWord');
            
            displayEl.textContent = `å•è¯ ${index + 1}`;
            displayEl.style.color = "#2d3748";

            // è¯»å•è¯ (é‡å¤ REPEAT_COUNT æ¬¡)
            for (let r = 0; r < REPEAT_COUNT; r++) {
                if (isPaused) return; // æš‚åœæ—¶æ‰“æ–­
                
                await speak(word.text);
                
                // å•è¯ä¹‹é—´çš„çŸ­æš‚é—´éš”ï¼Œæœ€åä¸€éè¯»å®Œåä¸ç­‰å¾…è¿™é‡Œï¼Œè€Œæ˜¯å»ç­‰é•¿é—´éš”
                if (r < REPEAT_COUNT - 1) {
                    await sleep(1500); 
                }
            }

            // ç­‰å¾…é—´éš”æ—¶é—´ (å€’è®¡æ—¶æ˜¾ç¤º)
            displayEl.style.color = "#718096";
            for (let t = INTERVAL / 1000; t > 0; t--) {
                if (isPaused) return; // æš‚åœé€»è¾‘éœ€å¤„ç†
                displayEl.textContent = `ç­‰å¾… ${t} ç§’...`;
                await sleep(1000);
            }
        }

        function speak(text) {
            return new Promise((resolve) => {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-GB'; // è‹±å¼å‘éŸ³ï¼Œä¹Ÿå¯ä»¥æ”¹ä¸º 'en-US'
                utterance.rate = 0.8; // ç¨å¾®æ”¾æ…¢è¯­é€Ÿé€‚åˆå¬å†™
                
                utterance.onend = () => {
                    resolve();
                };
                
                utterance.onerror = (e) => {
                    console.error("Speech error:", e);
                    resolve(); // å‡ºé”™ä¹Ÿç»§ç»­ï¼Œé¿å…å¡æ­»
                };

                window.speechSynthesis.speak(utterance);
            });
        }

        function updateProgress() {
            const total = currentDayWords.length;
            const current = currentIndex + 1;
            const percentage = Math.round((current / total) * 100);
            
            document.getElementById('currentProgress').textContent = `${current} / ${total}`;
            const bar = document.getElementById('progressBar');
            bar.style.width = `${percentage}%`;
            bar.textContent = `${percentage}%`;
        }

        function pauseDictation() {
            isPaused = true;
            window.speechSynthesis.cancel(); // åœæ­¢å½“å‰å‘éŸ³
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('resumeBtn').style.display = 'inline-block';
            document.getElementById('currentWord').textContent = "å·²æš‚åœ";
        }

        function resumeDictation() {
            isPaused = false;
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            // æ¢å¤æ—¶ï¼Œé€»è¾‘ä¼šä» dictateItem æˆ– sleep å¾ªç¯ä¸­ç»§ç»­
            // æ³¨æ„ï¼šç®€å•æ¢å¤å¯èƒ½å¯¼è‡´å½“å‰å•è¯é‡è¯»æˆ–è·³è¿‡å€’è®¡æ—¶ï¼Œç®€åŒ–å¤„ç†å³å¯
        }

        function resetDictation() {
            window.speechSynthesis.cancel();
            isRunning = false;
            isPaused = false;
            resetUI();
            loadDay();
        }

        function finishDictation() {
            isRunning = false;
            document.getElementById('currentWord').textContent = "å¬å†™å®Œæˆï¼";
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('restartBtn').style.display = 'inline-block';
            document.getElementById('daySelect').disabled = false;
            
            showAnswers();
        }

        function showAnswers() {
            const list = document.getElementById('answerList');
            list.innerHTML = '';
            
            currentDayWords.forEach((word, index) => {
                const item = document.createElement('div');
                item.className = 'answer-item';
                item.innerHTML = `
                    <div class="answer-left">
                        <span class="answer-number">${index + 1}.</span>
                        <span class="answer-text">${word.text}</span>
                    </div>
                    <span class="answer-meaning">${word.meaning}</span>
                `;
                list.appendChild(item);
            });

            document.getElementById('answers').style.display = 'block';
            // æ»šåŠ¨åˆ°åº•éƒ¨æŸ¥çœ‹ç­”æ¡ˆ
            document.getElementById('answers').scrollIntoView({ behavior: 'smooth' });
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>